<script>
    const username = "{{ username }}";
    const form = document.getElementById("quizForm");

    form.addEventListener("submit", function(e) {
        e.preventDefault();

        const responses = {};
        const formData = new FormData(form);

        for (let [key, value] of formData.entries()) {
            if (!responses[key]) responses[key] = [];
            responses[key].push(value);
        }

        fetch("/submit", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ username: username, responses: responses })
        })
        .then(res => res.json())
        .then(data => {
            alert(data.message);
            window.location.href = "/thankyou";
        });
    });
</script>
